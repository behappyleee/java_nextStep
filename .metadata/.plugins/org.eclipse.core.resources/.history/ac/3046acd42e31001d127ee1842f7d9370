package webserver;

import java.io.File;
import java.io.IOException;
import java.io.OutputStream;
import java.nio.file.Files;
import java.util.HashMap;

import org.slf4j.Logger;
import org.slf4j.LoggerFactory;

public class HttpResponse {
	
	Logger logger = LoggerFactory.getLogger(this.getClass());
	
	private static final String defaultPath = "./webapp";
	
	// 응답 데이터를 처리하는 로직을 별도의 클래스로 분리 
	// 응답 헤더 정보를 Map<String, String> 으로 관리 (RequestHandler 코드 중복을 줄이기 위함)
	// HTML/CSS/JavaScript 파일을 직접 읽어 응답으로 보내는 메서드는 forward() 다른 URL 로 리다이렉트 메서드는 sendRedirect() 로 관리
	
	HashMap<String, Object> responseHeaderInfo = new HashMap<>();
	
	OutputStream fileOutput;
	
	public HttpResponse(OutputStream fileOutputStream) {
		logger.debug("HTTP RESPONSE FILE OUTPUT STREAM : {} ", fileOutputStream);
		this.fileOutput = fileOutputStream;
	}
	
	// forward 메서드는 HTML / CS / JavaScript 파일을 직접 읽어 응답으로 보내는 메서드
	public void forward(String path) throws IOException {
		logger.debug("FILE DATA TEST PATH : {} " , defaultPath + path);
		byte[] readFile = Files.readAllBytes(new File(defaultPath + path).toPath());
		outputFileStream(readFile);
	}
	
	// 다른 URL로 리다이렉트 하는 메서드 
	public void sendRedirect() {
		
		
	}
	
	public String success200HeaderData() {
		StringBuilder headerData = new StringBuilder();
		headerData.append("");
		headerData.append("");
		headerData.append("");
		headerData.append("");
		headerData.append("");
		return headerData.toString();
	}
	
	// 파일 읽은 결과를 Body 에 출력 시켜줌 
	public void outputFileStream(byte[] bodyData) {
		try {
			fileOutput.write(bodyData);
		} catch(IOException e) {
			e.printStackTrace();
		}
	}
	
	
	
}
