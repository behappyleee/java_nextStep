package util;

import java.io.DataOutputStream;
import java.io.File;
import java.io.FileNotFoundException;
import java.io.FileOutputStream;
import java.io.IOException;
import java.io.OutputStream;

import org.junit.Test;
import org.slf4j.Logger;
import org.slf4j.LoggerFactory;

import webserver.HttpResponse;

public class HttpResponseTest {
	
	// HttpResponse Test 테스트 소스
	Logger logger = LoggerFactory.getLogger(this.getClass());
	
	private String testDirectory = "C:\\Users\\dhfhf\\Desktop\\myfolder\\workspace\\java_nextStep\\web-application-server\\src\\test\\resource\\";
	
	@Test
	public void responseForward() throws IOException {
		// Http_Forward.txt 결과는 응답 body 에 index.html 이 포함이 되어 있어야 함 
		HttpResponse httpResponse = new HttpResponse(createOuputStream("Http_Forward.txt"));
		httpResponse.forward("/index.html");
	}
	
	@Test
	public void responseRedirect() {
		// Http_Redirect 에 대한 결과는 응답 header 에 // Location 정보가 /index.html 에 포함이 되어있어야 함
		try {
			HttpResponse httpResponse = new HttpResponse(createOuputStream("Http_Redirect.txt"));
			httpResponse.sendRedirect("/index.html");
		} catch (FileNotFoundException e) {
			e.printStackTrace();
		}
	}
	
	@Test
	public void responseCookies() throws IOException {
		// Http_Cookie.txt 결과는 응답 header 에 Set-Cookie 값으로 logined=true 값이 포함되어 있어야 함
		try {
			HttpResponse httpResponse = new HttpResponse(createOuputStream("Http_Cookie.txt"));
			httpResponse.addHeader("Set-Cookie", "logined=ture");
			httpResponse.sendRedirect("/index.html");
		} catch (FileNotFoundException e) {
			e.printStackTrace();
		}
		
	}
	
	
	private OutputStream createOuputStream(String fileName) throws FileNotFoundException{
		return new FileOutputStream(new File(testDirectory + fileName));
	}
	
// REQUEST / RESPONSE 	
//	POST /user/create HTTP/1.1
//	Host: localhost:8080
//	Connection: keep-alive
//	Content-Length: 46
//	Content-Type: application/x-www-form-urlencoded
//	Accept: */*
//
//	userId=javajigi&password=password&name=JaeSung
//	
	
	
}
